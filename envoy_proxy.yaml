admin:
  access_log_path: /tmp/admin_access.log
  address:
    socket_address: { address: 127.0.0.1, port_value: 8081 }
static_resources:
listeners:
  - name: listener_0
    address:
      socket_address: { address: 0.0.0.0, port_value: 8080 }
    filter_chains:
      - filters:
        - name: envoy.http_connection_manager
        config:
        stat_prefix: ingress_http
route_config:
name: local_route
virtual_hosts:
- name: local_service
domains: [“xyz.host.com”]
routes:
- match: { prefix: “/”, query_parameters: [ {name: app, value: app1}, {name: action, value: subscribe} ] }
route: { prefix_rewrite: “/subscription/legacy/”, cluster: service_app1 }
- match: { prefix: “/”, query_parameters: [ {name: app, value: app1}, {name: action, value: unsubscribe} ] }
route: { prefix_rewrite: “/subscription/legacy/delete”, cluster: service_app1 }
http_filters:
- name: envoy.router
clusters:
- name: service_app1
connect_timeout: 5s
type: LOGICAL_DNS
# Comment out the following line to test on v6 networks
dns_lookup_family: V4_ONLY
lb_policy: ROUND_ROBIN
hosts: [{ socket_address: { address: app1.ns, port_value: 9001 }}]